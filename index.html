<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gobelins Students â€“ Logement Festival Annecy</title>
<link rel="stylesheet" href="style.css">
<style>
/* ---------------- PAGE MAIL ---------------- */
#gate {position:fixed; inset:0; background:#e6ebff; display:flex; align-items:center; justify-content:center; text-align:center; z-index:9999;}
.gate-card{background:#fff; padding:50px 35px; border-radius:25px; max-width:450px; width:90%; box-shadow:0 20px 40px rgba(0,0,0,0.08); display:flex; flex-direction:column; align-items:center;}
.gate-card h2{font-size:1.5em;font-weight:700;color:#3b3b3b;margin-bottom:15px;line-height:1.3;}
.gate-card p{font-size:1em;color:#5b5b5b;margin-bottom:25px;}
.gate-card input{width:100%; padding:14px; border-radius:12px; border:1px solid #b8b8b8; font-size:1em; margin-bottom:15px;}
.gate-card input:focus{outline:none;border-color:#6c7cff;}
#okBtn{padding:12px 25px; border:none; border-radius:12px; background:#6c7cff;color:white;font-weight:600;font-size:1em;margin-bottom:15px;}
#okBtn:hover{background:#5664e0;}
.lang-inline{display:flex; gap:12px; margin-top:25px;}
.lang-inline button{padding:5px 20px; font-size:0.85em; border-radius:12px; border:2px solid #6c7cff; background:#c6ccff; color:#6c7cff;}
.lang-inline button:hover{background:#aab8ff;}
#gateError{color:#d33; font-weight:500; margin-top:12px;}
</style>
</head>
<body>

<!-- ---------------- PAGE MAIL ---------------- -->
<div id="gate">
  <div class="gate-card">
    <h2 id="welcomeText" data-fr="Bienvenue sur la plateforme de logement Festival Annecy â€“ RÃ©servÃ©e aux Ã©tudiants Gobelins"
                    data-en="Welcome to the Annecy Festival Student Housing Platform â€“ Gobelins students only">
    </h2>
    <p id="instructionText" data-fr="Pour accÃ©der au site, veuillez entrer votre adresse mail Gobelins"
                            data-en="To access the site, please enter your Gobelins email">
    </p>
    <input type="email" id="gateEmail" placeholder="">
    <button id="okBtn" onclick="checkGate()">OK</button>
    <div class="lang-inline">
      <button onclick="setLang('fr')">FR</button>
      <button onclick="setLang('en')">EN</button>
    </div>
    <p id="gateError"></p>
  </div>
</div>

<!-- ---------------- SITE ---------------- -->
<div id="mainContent" style="display:none">
<header>
  <h1 data-fr="Logement Ã©tudiant â€“ Festival dâ€™Annecy ðŸŽ¨âœ¨"
      data-en="Student Housing â€“ Annecy Festival ðŸŽ¨âœ¨"></h1>
  <p data-fr="Plateforme solidaire entre Ã©tudiants Gobelins ðŸ’œ"
     data-en="A solidarity platform for Gobelins students ðŸ’œ"></p>
  <div class="lang-switch">
    <button onclick="setLang('fr')">FR</button>
    <button onclick="setLang('en')">EN</button>
  </div>
  <a class="main-btn"
     target="_blank"
     href="https://docs.google.com/forms/d/e/1FAIpQLSdnaTixbqudAQtLW9kk971NHRx2rfAjYjq5SrwV59T-Cq8U_Q/viewform?usp=header"
     data-fr="Faire une demande / proposer un logement ðŸ "
     data-en="Submit a request / offer accommodation ðŸ ">
  </a>
</header>

<section>
<h2 data-fr="Demandes et propositions de logement dÃ©jÃ  en ligne ðŸ“"
    data-en="Housing requests and offers already online ðŸ“"></h2>

<div class="filters">
  <select id="categoryFilter">
    <option value="" data-fr="CatÃ©gorie" data-en="Category"></option>
    <option value="search" data-fr="Cherche" data-en="Looking"></option>
    <option value="offer" data-fr="Propose" data-en="Offering"></option>
  </select>

  <select id="placesFilter">
    <option value="" data-fr="Nombre de places" data-en="Number of places"></option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3+">3+</option>
  </select>

  <select id="langFilter">
    <option value="" data-fr="Langues parlÃ©es" data-en="Languages spoken"></option>
    <option value="fr">FR</option>
    <option value="en">EN</option>
    <option value="both">FR+EN</option>
  </select>
</div>

<div id="cards"></div>
<div id="detail"></div>
</section>
</div>

<script>
/* ---------------- LANG ---------------- */
let currentLang="fr";
function setLang(lang){
  currentLang=lang;
  document.querySelectorAll("[data-fr]").forEach(el=>{
    el.textContent = el.dataset[lang] || el.dataset.fr;
  });
  renderFilters();
  renderCards(allData);
}

/* ---------------- GATE ---------------- */
function checkGate(){
  const emailInput=document.getElementById("gateEmail").value.trim();
  const error=document.getElementById("gateError");
  if(!emailInput.endsWith("@edu.gobelins.fr")){
    error.textContent = currentLang==="fr"?"Adresse Gobelins invalide":"Invalid Gobelins email";
    return;
  }
  localStorage.setItem("gobelinsAccess", emailInput);
  document.getElementById("gate").style.display="none";
  showSite();
}

function showSite(){
  document.getElementById("mainContent").style.display="block";
  loadData();
}

window.addEventListener("DOMContentLoaded",()=>{
  const saved=
